<?xml version = "1.0" encoding = "utf-8"?>
<!--
     /**
     *  Copyright 2009 The Regents of the University of California
     *  Licensed under the Educational Community License, Version 2.0
     *  (the "License"); you may not use this file except in compliance
     *  with the License. You may obtain a copy of the License at
     *
     *  http://www.osedu.org/licenses/ECL-2.0
     *
     *  Unless required by applicable law or agreed to in writing,
     *  software distributed under the License is distributed on an "AS IS"
     *  BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
     *  or implied. See the License for the specific language governing
     *  permissions and limitations under the License.
     *
     */
-->
<mx:Canvas 
    xmlns:mx = "http://www.adobe.com/2006/mxml"
    backgroundAlpha = "1.0"
    currentState = "{model.currentPlayerState}"
    xmlns:view = "org.opencast.engage.videodisplay.view.*"
    verticalScrollPolicy = "off"
    horizontalScrollPolicy = "off"
    >

    <mx:Script>
        <![CDATA[
        	import org.osmf.layout.VerticalAlign;
        	import bridge.ExternalFunction;
            import org.opencast.engage.videodisplay.control.event.SetVolumeEvent;
            import org.opencast.engage.videodisplay.state.PlayerState;
            import org.opencast.engage.videodisplay.control.event.VideoControlEvent;
            import org.swizframework.Swiz;
            import org.opencast.engage.videodisplay.model.VideodisplayModel;
            import mx.controls.Alert;
            import mx.core.Application;

            [Autowire]
            [Bindable]
            public var model:VideodisplayModel;

                        /**
             * showButton
             *
             * Show the Button in the middle of the video
             *
             * */
            private function showButton():void
            {
                if ( this.currentState == PlayerState.PLAYING )
                {
                    pauseButton_up.visible = true;
                }
                else
                {
                    playButton_up.visible = true;
                }
            }

            /**
             * hideButton
             *
             * Hide the Button in the middle of the video
             *
             * */
            private function hideButton():void
            {
                if ( this.currentState == PlayerState.PLAYING )
                {
                    pauseButton_up.visible = false;
                }
                else
                {
                    playButton_up.visible = false;
                }

            }

            /**
             * fullscreen
             *
             * Toggle between normal screen and full screen mode
             *
             **/
            private function fullscreen():void
            {
                Application.application.stage.displayState = StageDisplayState.FULL_SCREEN;
                model.fullscreenMode = true;
                model.layoutMetadataParallelElement.verticalAlign = VerticalAlign.MIDDLE;
            }
        ]]>
    </mx:Script>

    <mx:states>

        <mx:State 
            name = "{PlayerState.PLAYING}"
            >

            <mx:SetProperty 
                target = "{playButton_up}"
                name = "visible"
                value = "false"
                />

            <mx:SetProperty 
                target = "{pauseButton_up}"
                name = "visible"
                value = "false"
                />
        </mx:State>

        <mx:State 
            name = "{PlayerState.PAUSING}"
            >

            <mx:SetProperty 
                target = "{playButton_up}"
                name = "visible"
                value = "true"
                />

            <mx:SetProperty 
                target = "{pauseButton_up}"
                name = "visible"
                value = "false"
                />
        </mx:State>
    </mx:states>

    <mx:transitions>

        <mx:Transition 
            id = "fadeOut"
            fromState = "{PlayerState.PLAYING}"
            toState = "{PlayerState.PAUSING}"
            >

            <mx:Parallel 
                target = "{curtain}"
                />
        </mx:Transition>

        <mx:Transition 
            id = "fadeIn"
            fromState = "{PlayerState.PAUSING}"
            toState = "{PlayerState.PLAYING}"
            >

            <mx:Parallel 
                target = "{curtain}"
                />
        </mx:Transition>
    </mx:transitions>

    <mx:Canvas 
        id = "curtain"
        backgroundColor = "#000000"
        backgroundAlpha = "0.0"
        width = "60"
        height = "60"
        horizontalCenter = "0"
        verticalCenter = "0"
        rollOver = "{ showButton(); }"
        rollOut = "{ hideButton(); }"
        verticalScrollPolicy = "off"
        horizontalScrollPolicy = "off"
        />

    <mx:Button 
        id = "playButton_up"
        click = "{ ExternalInterface.call( ExternalFunction.PLAYPAUSE, '' ) }"
        width = "{this.width/10}"
        height = "{playButton_up.width}"
        styleName = "PlayBig"
        visible = "false"
        verticalCenter = "0"
        horizontalCenter = "0"
        buttonMode = "true"
        rollOver = "{ showButton(); }"
        rollOut = "{ hideButton(); }"
        toolTip = "Play"
        />

    <mx:Button 
        id = "pauseButton_up"
        click = "{ ExternalInterface.call( ExternalFunction.PLAYPAUSE, '' ) }"
        width = "{this.width/10}"
        height = "{pauseButton_up.width}"
        styleName = "PauseBig"
        visible = "false"
        verticalCenter = "0"
        horizontalCenter = "0"
        buttonMode = "true"
        rollOver = "{ showButton(); }"
        rollOut = "{ hideButton(); }"
        toolTip = "Pause"
        />
        
       
    <mx:SWFLoader 
    	source="@Embed(source='../../../../../style/oc_logo_loader.swf')" 
        scaleContent="true" 
        autoLoad="true"
        verticalCenter = "0"
        horizontalCenter = "0"
        visible="{ model.loader }"
        includeInLayout="{ model.loader }"
        />
       
    
    <mx:VBox
    	width="100%"
    	height="100%"
    	>
    	
    	<mx:HBox 
    		width="100%"
    		horizontalAlign="right"
    		>
    		
    	<mx:Button 
            styleName="Fullscreen"
            visible = "{!model.fullscreenMode}"
            includeInLayout = "{!model.fullscreenMode}"
            click = "{ fullscreen() }"
            />
    		
    	</mx:HBox>
   
        <mx:Spacer 
	       height="100%"
	       />

        <mx:VBox 
            width = "100%"
            verticalScrollPolicy = "off"
            horizontalScrollPolicy = "off"
            bottom="10"
            >
             
        <mx:Label 
            text="Total: { model.bytesTotal.toString() }"
            color="#ffffff"
            />
            
        <mx:Label 
            text="Laoded: { model.bytesLoaded.toString() }"
            color="#ffffff"
            />
            
            
             <mx:Label 
            text="font: { model.fontSizeCaptions.toString() }"
            color="#ffffff"
            />
            
             <mx:Label 
            text="progress: { model.progress.toString() }"
            color="#ffffff"
            />
        
            <view:CaptionsView 
                id = "captionsView"
                width = "100%"
                horizontalAlign = "center"
                />

            <mx:Spacer 
                height = "20"
                visible = "{model.fullscreenMode}"
                includeInLayout = "{model.fullscreenMode}"
                />
                
            <view:FullscreenVideoControlsView 
                id = "videocontrollerView"
                width = "100%"
                height = "100%"
                visible = "{model.fullscreenMode}"
                includeInLayout = "{model.fullscreenMode}"
                />
	     
	     </mx:VBox>
     
    </mx:VBox>

</mx:Canvas>
